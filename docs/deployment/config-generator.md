---
title: Config Generator
parent: Deployment
nav_order: 4
---

# Config Generator

{: .warning }
This generator is still in active development. There will be bugs.

<script src="/deployment/config-generator.js"></script>
<form onsubmit="javascript:configGenerate(event)" id="configForm">

<fieldset>
  <legend>Basic</legend>

  <p>
    <label for="ClientMode">Client Mode</label>
    <select name="ClientMode" id="ClientMode">
      <option value="ClientMode_Monitor">Monitor</option>
      <option value="ClientMode_Lockdown">Lockdown</option>
    </select>
    <p class="fs-2">In Monitor mode, Santa will only block binaries that have explicit block rules.</p>
    <p class="fs-2">In Lockdown mode, Santa will block anything that doesn't have an allow rule.</p>
  </p>

  <p>
    <label for="FailClosed">Fail Closed</label>
    <input type="checkbox" id="FailClosed" />
    <p class="fs-2">There are a few rare cases where Santa can fail to properly determine whether a binary should be allowed or denied. In these cases Santa will default to allowing the binary to execute. If this option is enabled, Santa will instead deny these executions.</p>
  </p>

  <p>
    <label for="EnableBadSignatureProtection">Enable Bad Signature Protection</label>
    <input type="checkbox" id="EnableBadSignatureProtection" />
    <p class="fs-2">If enabled, Santa will block any binary with a bad code signature even in monitor mode, unless there is an explicit binary rule.</p>
  </p>

  <p>
    <label for="EnablePageZeroProtection">Enable PAGEZERO Protection</label>
    <input type="checkbox" id="EnablePageZeroProtection" checked />
    <p class="fs-2">If enabled, 32-bit x86 binaries that are missing the __PAGEZERO segment will be blocked, regardless of client mode, unless an explicit binary rule allows it.</p>
  </p>

  <p>
    <label for="EnableSilentMode">Silent Mode</label>
    <input type="checkbox" id="EnableSilentMode" />
    <p class="fs-2">If enabled, Santa will not post any GUI notifications. This can be a confusing experience for users so use with caution.</p>
  </p>

  <p>
    <label for="EnableSilentTTYMode">Silent TTY Mode</label>
    <input type="checkbox" id="EnableSilentTTYMode" />
    <p class="fs-2">If enabled, Santa will not post any TTY notifications. This can be a confusing experience for users (especially over SSH) so use with caution.</p>
  </p>

  <p>
    <label for="IgnoreOtherEndpointSecurityClients">Ignore other endpoint security clients</label>
    <input type="checkbox" id="IgnoreOtherEndpointSecurityClients" />
    <p class="fs-2">If enabled, Santa will not process any events generated by other EndpointSecurity clients on the machine. This exists to help address any compatibility issues that may arise from other EndpointSecurity clients.</p>
  </p>

  <p>
    <label for="EnableTransitiveRules">Enable Transitive Rules</label>
    <input type="checkbox" id="EnableTransitiveRules" />
    <p class="fs-2">If enabled, Santa will respect "COMPILER" rules and create temporary allow rules for files generated by binaries matching.</p>
  </p>

  <p>
    <label for="FileChangesRegex">File Changes Regex</label>
    <input type="string" id="FileChangesRegex" />
  </p>

  <p>
    <label for="FileChangesPrefixFilters">File Changes Prefix Filters</label>
    <textarea rows=10 cols=30 id="FileChangesPrefixFilters" placeholder="One entry per line"></textarea>
  </p>

  <p>
    <label for="AllowedPathRegex">Allowed Path Regex</label>
    <input type="string" id="AllowedPathRegex" />
  </p>

  <p>
    <label for="BlockedPathRegex">Blocked Path Regex</label>
    <input type="string" id="BlockedPathRegex" />
  </p>
</fieldset>

<br />

<fieldset>
  <legend>UI</legend>

  <p>
    <label for="AboutText">About Text</label>
    <input type="string" id="AboutText" />
    <p class="fs-2">When a user opens /Applications/Santa.app, this is the text shown in the middle of the "About" dialog.</p>
  </p>

  <p>
    <label for="MoreInfoURL">More info URL</label>
    <input type="string" id="MoreInfoURL" />
    <p class="fs-2">When a user opens /Applications/Santa.app, this is the URL that they will be taken to when clicking the "More Info..." button. If this value is not set, the button is removed.</p>
  </p>

  <p>
    <label for="EventDetailURL">Event Detail URL</label>
    <input type="string" id="EventDetailURL" />
    <p class="fs-2">The URL the user is taken to when clicking the "Open..." button on the block dialog.</p>
    <p class="fs-2">The URL may contain several placeholder values which will be replaced with values from the event:</p>
    <p class="fs-2"><code>%file_identifier%</code>: The SHA-256 of the file that was blocked.</p>
    <p class="fs-2"><code>%bundle_or_file_identifier%</code>: The SHA-256 of the file that was blocked or the bundle containing it, if available.</p>
    <p class="fs-2"><code>%machine_id%</code>: The configured ID of this machine.</p>
    <p class="fs-2"><code>%username%</code>: The username of the user that tried to execute this binary.</p>
    <p class="fs-2"><code>%serial%</code>: The serial number of this machine.</p>
    <p class="fs-2"><code>%uuid%</code>: The UUID of this machine.</p>
    <p class="fs-2"><code>%hostname%</code>: The FQDN of this machine.</p>
  </p>

  <p>
    <label for="EventDetailText">Event detail text</label>
    <input type="string" id="EventDetailText" />
    <p class="fs-2">If set, this text replaces "Open..." on the button that opens a URL on a block dialog.</p>
  </p>

  <p>
    <label for="UnknownBlockMessage">Unknown block message</label>
    <input type="string" id="UnknownBlockMessage" />
    <p class="fs-2">Overrides the default text shown on a block dialog for a binary that was blocked because no rule exists and the machine is in Lockdown mode. If unset, a reasonable default is provided.</p>
  </p>

  <p>
    <label for="BannedBlockMessage">Banned block message</label>
    <input type="string" id="BannedBlockMessage" />
    <p class="fs-2">Overrides the default text shown on a block dialog for a binary that has been explicitly blocked by a block rule. If unset, a reasonable default is provided.</p>
  </p>

  <p>
    <label for="ModeNotificationMonitor">Mode notification text for Monitor mode</label>
    <input type="string" id="ModeNotificationMonitor" />
    <p class="fs-2">Overrides the default text shown on the notification shown when a client goes into Monitor mode.</p>
    <p class="fs-2">The default text is "Switching into Monitor mode".</p>
    <p class="fs-2">Note that this must fit into the small notifications used by the OS or it will be truncated.</p>
  </p>

  <p>
    <label for="ModeNotificationLockdown">Mode notification text for Lockdown mode</label>
    <input type="string" id="ModeNotificationLockdown" />
    <p class="fs-2">Overrides the default text shown on the notification shown when a client goes into Lockdown mode.</p>
    <p class="fs-2">The default text is "Switching into Lockdown mode".</p>
    <p class="fs-2">Note that this must fit into the small notifications used by the OS or it will be truncated.</p>
  </p>
</fieldset>

<br />

<fieldset>
  <legend>Machine Identity</legend>

  <p>
    <label for="MachineOwner">Owner</label>
    <input type="string" id="MachineOwner" />
    <p class="fs-2">Specifies the name of the machine's "owner".</p>
  </p>

  <p>
    <label for="MachineID">ID</label>
    <input type="string" id="MachineID" />
    <p class="fs-2">Specifies a unique ID for the machine.</p>
  </p>

  <p>
    <label for="MachineOwnerPlist">Owner Plist File</label>
    <input type="string" id="MachineOwnerPlist" />
    <p class="fs-2">Specifies the path to a Plist file that contains the name of the machine's owner.</p>
  </p>

  <p>
    <label for="MachineOwnerKey">Owner Plist Key</label>
    <input type="string" id="MachineOwnerKey" />
    <p class="fs-2">Specifies the key to read from MachineOwnerPlist.</p>
  </p>

  <p>
    <label for="MachineIDPlist">ID Plist File</label>
    <input type="string" id="MachineIDPlist" />
    <p class="fs-2">Specifies the path to a Plist file that contains the unique ID of the machine's.</p>
  </p>

  <p>
    <label for="MachineIDKey">ID Plist Key</label>
    <input type="string" id="MachineIDKey" />
    <p class="fs-2">Specifies the key to read from MachineIDPlist.</p>
  </p>
</fieldset>

<br />

<fieldset>
  <legend>Static Rules</legend>

  <p>
    <label>Rules</label>
    <p class="fs-2">The <code>StaticRules</code> key is not yet implemented</p>
  </p>
</fieldset>

<br />

<fieldset>
  <legend>Sync</legend>

  <p>
    <label for="SyncBaseURL">Sync server base URL</label>
    <input type="string" id="SyncBaseURL" />
    <p class="fs-2">The base URL of a sync server to connect to.</p>
    <p class="fs-2">Setting this will disable local rule management.</p>
  </p>

  <p>
    <label for="SyncEnableCleanSyncEventUpload">Upload events even for clean syncs</label>
    <input type="string" id="SyncEnableCleanSyncEventUpload" />
    <p class="fs-2">Ordinarily when a clean sync occurs, Santa will erase any pending events instead of uploading them.</p>
    <p class="fs-2">This is because it's unlikely the events uploaded will be useful</p>
    <p class="fs-2">If this setting is enabled, Santa will upload pending events even when doing clean syncs.</p>
  </p>

  <p>
    <label for="ClientAuthCertificateFile">Client certificate file path</label>
    <input type="string" id="ClientAuthCertificateFile" />
    <p class="fs-2">If set, this points to a file containing a valid client certificate (as a PKCS#12 file)</p>
  </p>

  <p>
    <label for="ClientAuthCertificatePassword">Client certificate file password</label>
    <input type="string" id="ClientAuthCertificatePassword" />
    <p class="fs-2">If set, this is the password for the file specified in ClientAuthCertificateFile</p>
  </p>

  <p>
    <label for="ClientAuthCertificateCN">Client certificate common name</label>
    <input type="string" id="ClientAuthCertificateCN" />
    <p class="fs-2">If set, this is the common name of a certificate in the System keychain to use for sync authentication.</p>
    <p class="fs-2">The corresponding private key must also be in the keychain.</p>
  </p>

  <p>
    <label for="ClientAuthCertificateIssuerCN">Client certificate issuer common name</label>
    <input type="string" id="ClientAuthCertificateIssuerCN" />
    <p class="fs-2">If set, this is the common name of the issuer of a client certificate in the System keychain to use for sync authentication.</p>
    <p class="fs-2">If there are multiple certificates in the keychain issued by this cert, the first one found will be used.</p>
    <p class="fs-2">The corresponding private key must also be in the keychain.</p>
  </p>

  <p>
    <label for="ServerAuthRootsFile">Server Roots File</label>
    <input type="string" id="ServerAuthRootsFile" />
    <p class="fs-2">If set, this is the path of a file containing a one ore more certificates in PEM format to use to validate the server's HTTPS certificate.</p>
    <p class="fs-2">To comply with <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CocoaKeys.html#//apple_ref/doc/uid/TP40009251-SW57">App Transport Security</a> requirements, the certificates must also be trusted in the keychain</p>
    <p class="fs-2">This is intended just to limit the set of trusted roots that the certificate can chain up to, to limit the possibility of a man-in-the-middle attack.</p>
  </p>

  <p>
    <label for="SyncClientContentEncoding">Content Encoding</label>
    <select name="SyncClientContentEncoding" id="SyncClientContentEncoding">
      <option value="SyncClientContentEncoding_deflate" selected>deflate</option>
      <option value="SyncClientContentEncoding_gzip">gzip</option>
      <option value="SyncClientContentEncoding_none">none</option>
    </select>
    <p class="fs-2">Sets the Content-Encoding for requests made to the sync server.</p>
  </p>

  <p>
    <label>Sync Extra Headers</label>
    <p class="fs-2">The <code>SyncExtraHeaders</code> key is not yet implemented</p>
  </p>

  <p>
    <label for="EnableAllEventUpload">Upload all events</label>
    <input type="checkbox" id="EnableAllEventUpload" />
    <p class="fs-2">If enabled, Santa will upload events to the sync server for all executions, including those covered by an allow rule.</p>
  </p>

  <p>
    <label for="DisableUnknownEventUpload">Disable unknown event upload</label>
    <input type="checkbox" id="DisableUnknownEventUpload" />
    <p class="fs-2">If enabled, Santa will not upload events for executions of unknown binaries allowed while in Monitor mode.</p>
    <p class="fs-2">Ordinarily, Santa will upload these events so that during deployment of Santa the sync server can be populated with details about all the binaries that <em>would</em> have been blocked had machines been in lockdown.</p>
  </p>

</fieldset>

<fieldset>
  <legend>Logging</legend>

  <p>
    <label for="EventLogType">Event Log Type</label>
    <select name="EventLogType" id="EventLogType">
      <option value="EventLogType_syslog">Syslog</option>
      <option value="EventLogType_filelog" selected>Filelog</option>
      <option value="EventLogType_protobuf">Protobuf</option>
      <option value="EventLogType_json">JSON</option>
      <option value="EventLogType_null">null</option>
    </select>
    <p class="fs-2">Defines how event logs are stored.</p>
    <p class="fs-2"><em>syslog</em>: Logs are sent to the Unified Logging System.</p>
    <p class="fs-2"><em>filelog</em>: Logs are stored in plain text files.</p>
    <p class="fs-2"><em>protobuf</em>: Logs are stored on-disk in a maildir-style format as a protocol buffer.</p>
    <p class="fs-2"><em>json</em>: Logs are stored on-disk as JSON file, one object per line.</p>
    <p class="fs-2"><em>null</em>: Logs are not generated at all.</p>
  </p>

  <p>
    <label for="EventLogPath">Event Log Path</label>
    <input type="string" id="EventLogPath" />
    <p class="fs-2">The path to store event logs in. Used for <code>filelog</code> and <code>json</code></p>
    <p class="fs-2">Defaults to <code>/var/db/santa/santa.log</code></p>
    <p class="fs-2">If you change this, ensure you update your <code>com.google.santa.newsyslog.conf</code> file to handle rotation!</p>
  </p>

  <p>
    <label for="SpoolDirectory">Spool Directory</label>
    <input type="string" id="SpoolDirectory" />
    <p class="fs-2">The directory to store event logs in. Used for <code>protobuf</code></p>
    <p class="fs-2">Defaults to <code>/var/db/santa/spool</code></p>
  </p>

  <p>
    <label for="SpoolDirectoryFileSizeThresholdKB">Spool Directory File Size Threshold</label>
    <input type="number" id="SpoolDirectoryFileSizeThresholdKB" value="100" />
    <p class="fs-2">The maximum size of each file stored in the spool directory.</p>
    <p class="fs-2">Events are buffered in memory until this threshold would be exceeded (or the maximum flush time is reached).</p>
    <p class="fs-2">Only applies to the <code>protobuf</code> EventLogType</p>
  </p>

  <p>
    <label for="SpoolDirectorySizeThresholdMB">Spool Directory Total Size Threshold</label>
    <input type="number" id="SpoolDirectorySizeThresholdMB" value="100" />
    <p class="fs-2">The maximum size of the spool directory. If this limit is reached, no more events will be emitted.</p>
    <p class="fs-2">Only applies to the <code>protobuf</code> EventLogType</p>
  </p>

  <p>
    <label for="SpoolDirectoryEventMaxFlushTimeSec">Spool Directory maximum time between flushes</label>
    <input type="number" id="SpoolDirectoryEventMaxFlushTimeSec" value="10" />
    <p class="fs-2">The maximum number of seconds that events will stay buffered in memory before being flushed to disk.</p>
    <p class="fs-2">Only applies to the <code>protobuf</code> EventLogType</p>
  </p>

  <p>
    <label for="EnableForkAndExitLogging">Enable fork() and exit logging</label>
    <input type="checkbox" id="EnableForkAndExitLogging" />
    <p class="fs-2">If enabled, Santa will log FORK and EXIT events.</p>
  </p>

  <p>
    <label for="EnableMachineIDDecoration">Enable machine ID decoration</label>
    <input type="checkbox" id="EnableMachineIDDecoration" />
    <p class="fs-2">If true, the machine ID will be added to every log entry.</p>
  </p>

  <p>
    <label for="EnableDebugLogging">Enable debug logging</label>
    <input type="checkbox" id="EnableDebugLogging" />
    <p class="fs-2">If true, Santa will log additional debug messages to the ULS system log.</p>
  </p>

  <p>
    <label for="EntitlementsPrefixFilter">Entitlements Prefix Filters</label>
    <textarea rows=10 cols=30 id="EntitlementsPrefixFilter" placeholder="One entry per line"></textarea>
    <p class="fs-2">A list of entitlement prefixes that should not be logged.</p>
  </p>

  <p>
    <label for="EntitlementsTeamIDFilter">Entitlements Team ID Filters</label>
    <textarea rows=10 cols=30 id="EntitlementsTeamIDFilter" placeholder="One entry per line"></textarea>
    <p class="fs-2">Entitlements from processes with a matching Team ID in their code signature will not be logged.</p>
    <p class="fs-2">Use the value <code>platform</code> to filter entitlements from platform binaries.</p>
  </p>
</fieldset>

<br />

<fieldset>
  <legend>Metrics</legend>

  <p>
    <label for="MetricFormat">Format</label>
    <select name="MetricFormat" id="MetricFormat">
      <option value="MetricFormat_">none</option>
      <option value="MetricFormat_rawjson">rawjson</option>
      <option value="MetricFormat_monarchjson">monarchjson</option>
    </select>
    <p class="fs-2">The export format for metrics sent to <code>MetricURL</code></p>
    <p class="fs-2"><code>none</code> disables metric exporting.</p>
    <p class="fs-2"><code>rawjson</code> exports a single JSON blob.</p>
    <p class="fs-2"><code>monarchjson</code> exports a format supported by Google's internal tooling.</p>
  </p>

  <p>
    <label for="MetricURL">Export URL</label>
    <input type="string" id="MetricURL" />
    <p class="fs-2">URL to which monitoring metrics should be exported.</p>
  </p>

  <p>
    <label for="MetricExportInterval">Export Interval</label>
    <input type="number" id="MetricExportInterval" value="30" />
    <p class="fs-2">Number of seconds to wait between metrics exports.</p>
  </p>

  <p>
    <label for="MetricExportTimeout">Export Timeout</label>
    <input type="number" id="MetricExportTimeout" value="30" />
    <p class="fs-2">Number of seconds a single export request can take before timing out.</p>
  </p>

  <p>
    <label>Extra Labels</label>
    <p class="fs-2">The <code>MetricExtraLabels</code> key is not yet implemented</p>
    <!-- MetricExtraLabels	Dictionary	A map of key value pairs to add to all metric root labels. (e.g. a=b,c=d) defaults to @{}). If a previously set key (e.g. host_name is set to "" then the key is remove from the metric root labels. Alternatively if a value is set for an existing key then the new value will override the old.  -->
  </p>

</fieldset>

<br />

<fieldset>
  <legend>USB Blocking</legend>

  <p>
    <label for="BlockUSBMount">Enable USB Blocking</label>
    <input type="checkbox" id="BlockUSBMount" />
    <p class="fs-2">If true, blocking USB mass storage feature is enabled.</p>
  </p>

  <p>
    <label for="RemountUSBMode">Remount Mode</label>
    <textarea rows=10 cols=30 id="RemountUSBMode" placeholder="One entry per line"></textarea>
    <p class="fs-2">A list of arguments that will be passed to <code>mount -o</code> when remounting.</p>
    <p class="fs-2">Allowed values include <code>rdonly</code>, <code>noexec</code>, <code>nosuid</code>, <code>nobrowse</code>, <code>noowners</code>, <code>nodev</code></p>
  </p>

  <p>
    <label for="OnStartUSBOptions">Startup Options</label>
    <select name="OnStartUSBOptions" id="OnStartUSBOptions">
      <option value="OnStartUSBOptions_">none</option>
      <option value="OnStartUSBOptions_Unmount">Unmount</option>
      <option value="OnStartUSBOptions_ForceUnmount">ForceUnmount</option>
      <option value="OnStartUSBOptions_Remount">Remount</option>
      <option value="OnStartUSBOptions_ForceRemount">ForceRemount</option>
    </select>
    <p class="fs-2">If set, defines the action that should be taken on existing USB mounts when Santa starts up.</p>
    <p class="fs-2"><code>none</code> disables metric exporting.</p>
    <p class="fs-2"><code>Unmount</code> unmounts all matching mounts.</p>
    <p class="fs-2"><code>ForceUnmount</code> forcibly unmounts all matching mounts.</p>
    <p class="fs-2"><code>Remount</code> remounts all matching mounts.</p>
    <p class="fs-2"><code>ForceRemount</code> forcibly remounts all matching mounts.</p>
  </p>

  <p>
    <label for="BannedUSBBlockMessage">Banned block message</label>
    <input type="string" id="BannedUSBBlockMessage" />
    <p class="fs-2">Overrides the default text shown on a block dialog when a USB device is prevented from being mounted.</p>
  </p>

  <p>
    <label for="RemountUSBBlockMessage">Remount block message</label>
    <input type="string" id="RemountUSBBlockMessage" />
    <p class="fs-2">Overrides the default text shown on a block dialog when a USB device is allowed to be mounted with a subset of the requested flags as defined by RemountUSBMode.</p>
  </p>
</fieldset>

<br />

<fieldset>
  <legend>File Access Authorization (FAA)</legend>

  <p>
    <label for="FileAccessPolicyPlist">Policy Plist</label>
    <input type="string" id="FileAccessPolicyPlist" />
    <p class="fs-2">Path to a file on-disk containing a file access configuration policy.</p>
    <p class="fs-2">Ignored if <code>FileAccessPolicy</code> is also set.</p>
  </p>

  <p>
    <label for="FileAccessPolicyUpdateIntervalSec">Export Timeout</label>
    <input type="number" id="FileAccessPolicyUpdateIntervalSec" value="600" />
    <p class="fs-2">Number of seconds between re-reading the file access policy config and policies/monitored paths updated.</p>
  </p>

  <p>
    <label for="FileAccessBlockMessage">Block message</label>
    <input type="string" id="FileAccessBlockMessage" />
    <p class="fs-2">This is the message shown to the user when a access to a file is blocked because of a rule defined by FileAccessPolicy if that rule doesn't provide a custom message. If this is not configured a reasonable default is provided.</p>
  </p>

  <p>
    <label for="OverrideFileAccessAction">Override action</label>
    <select name="OverrideFileAccessAction" id="OverrideFileAccessAction">
      <option value="OverrideFileAccessAction_">none</option>
      <option value="OverrideFileAccessAction_auditonly">auditonly</option>
      <option value="OverrideFileAccessAction_disabled">disabled</option>
    </select>
    <p class="fs-2">Defines a global override policy that applies to the enforcement of all FileAccessPolicy rules.</p>
    <p class="fs-2"><code>none</code>: enforce policy as defined in each rule</p>
    <p class="fs-2"><code>auditonly</code>: no access will be blocked, only logged</p>
    <p class="fs-2"><code>disabled</code>: no access will be blocked or logged</p>
  </p>

  <p>
    <label>FileAccessPolicy</label>
    <p class="fs-2">The <code>FileAccessPolicy</code> key is not yet implemented</p>
    <!-- FileAccessPolicy	Dictionary	A complete file access configuration policy embedded in the main Santa config. If set, FileAccessPolicyPlist will be ignored.  -->
  </p>
</fieldset>

<br />

<div align="center"> <button class="btn btn-blue">Generate!</button> </div>

</form>
